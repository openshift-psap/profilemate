â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ProfileMate Quick Debug Reference
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ENABLE DEBUG MODE:
  export VLLM_PROFILING_DEBUG=1
  export VLLM_NO_USAGE_STATS=1

RUN WITH DEBUG:
  export PYTHONPATH="/path/to/profilemate:$PYTHONPATH"
  python -m vllm.entrypoints.openai.api_server \
      --model facebook/opt-125m \
      --port 8000 \
      2>&1 | tee vllm_debug.log

WHAT TO LOOK FOR IN LOGS:
  âœ… "[sitecustomize] vLLM Comprehensive Instrumentation Loaded"
     â†’ ProfileMate is active

  âœ… "[Instrumentation] Successfully patched CUDAGraphWrapper"
     â†’ CUDA graph profiling will work

  âœ… "[CUDA Graph] âœ… CAPTURED: FULL:BatchDescriptor(...)"
     â†’ New CUDA graph captured

  âœ… "[CUDA Graph] ğŸ”„ REPLAY #1: FULL:... (12.45ms)"
     â†’ CUDA graph replay detected

CHECK PATCHES APPLIED:
  grep "Successfully patched" vllm_debug.log

CHECK DATA COLLECTED:
  ls -lh /tmp/vllm_profiling/session_*/
  wc -l /tmp/vllm_profiling/session_*/cuda_graph_captures.csv

ANALYZE RESULTS:
  python3 -c "
  import pandas as pd
  import glob
  session = max(glob.glob('/tmp/vllm_profiling/session_*/'))
  print(f'Session: {session}')
  captures = pd.read_csv(f'{session}/cuda_graph_captures.csv')
  print(f'Unique graphs: {len(captures)}')
  usage = pd.read_csv(f'{session}/cuda_graph_usage.csv')
  print(f'Total replays: {usage[\"replay_count\"].sum()}')
  "

ABOUT VLLM_NO_USAGE_STATS:
  â€¢ Disables vLLM telemetry (anonymous usage stats)
  â€¢ Fixes cpuinfo JSONDecodeError crash
  â€¢ Completely safe - just skips optional feature
  â€¢ NOT related to ProfileMate

TROUBLESHOOTING:
  Problem: No sitecustomize message
    â†’ Check: echo $PYTHONPATH
    â†’ Fix: export PYTHONPATH="/path/to/profilemate:$PYTHONPATH"

  Problem: No "Successfully patched" messages
    â†’ Check: python3 check_vllm_compatibility.py
    â†’ vLLM version may be incompatible

  Problem: Zero stats in CSV files
    â†’ Enable: export VLLM_PROFILING_DEBUG=1
    â†’ Send test requests
    â†’ Watch for CAPTURED/REPLAY messages

  Problem: cpuinfo JSONDecodeError
    â†’ This is vLLM bug, NOT ProfileMate
    â†’ Fix: export VLLM_NO_USAGE_STATS=1

FULL GUIDE:
  See: DEBUG_GUIDE.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
